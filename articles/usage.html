<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="blotbench">
<title>usage • blotbench</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="usage">
<meta property="og:description" content="blotbench">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">blotbench</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/usage.html">usage</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>usage</h1>
            
      
      
      <div class="d-none name"><code>usage.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/blotbench/">blotbench</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When preparing western blots for presentation, typical workflows at
one point usually involve cropping the blots in something like
PhotoShop, GIMP, FIJI, etc. Because this manipulation was done in a
separate program, usually the best we can do in terms of reproducibility
is by providing the original, unmodified images along with the cropped
version.</p>
<p>This is fine - it certainly is convenient and I don’t blame anyone
for doing it (particularly busy scientists). There are methods for
declaratively doing image manipulations in R (particularly
<code>magick</code> and <code>EBImage</code>), but they aren’t nearly as
convenient as the real-time visual feedback of typical photo-editing
software - the guess-then-render-repeat loop of trying to find the
perfect cropping geometry for an image <em>without</em> this visual
feedback is tedious at best, and a hard-sell if you’re trying to get
others to join the reproducibility movement.</p>
<p><code>blotbench</code> attempts to solve this by providing a
<code>Shiny</code> app within the package to perform rudimentary image
manipulations with visual feedback. This app outputs code that should be
written to create these transformations (rather than the image itself)
so the declarative and reproducible benefits of a script can be reaped
while still leveraging the convenience of a graphical interface.</p>
<p>In addition, <code>blotbench</code> introduces a new object (a
<code>wb</code> object) that can store row and column annotation much
like a <code>SummarizedExperiment</code>. This provides additional
benefits such as intuitive indexing (to allow you to treat a blot image
almost like a <code>data.frame</code>) and automatic annotation.</p>
</div>
<div class="section level2">
<h2 id="creating-a-wb-object">Creating a <code>wb</code> object<a class="anchor" aria-label="anchor" href="#creating-a-wb-object"></a>
</h2>
<p>A <code>wb</code> object is composed of 4 components:</p>
<ol style="list-style-type: decimal">
<li>imgs: A vector of <code>image-magick</code> images</li>
<li>col_annot: A <code>data.frame</code> containing lane annotation, one
line for each column, with the top row referring to the left-most
lane</li>
<li>row_annot: A <code>data.frame</code> containing names of the protein
blotted for in each image.</li>
<li>transforms: A <code>data.frame</code> containing information
detailing what transformations should be performed on the image for
presentation.</li>
</ol>
<p>When creating a <code>wb</code> object, you typically will not
specify the transforms at the outset, and both <code>col_annot</code>
and <code>row_annot</code> are optional. At bare minimum, you need to
supply a vector of <code>image-magick</code> images. To show you the
full power of <code>blotbench</code> though, I’m going to supply
arguments 1-3.</p>
<p>First, let’s introduce our images.</p>
<p>Our experiment was a timecourse of cells exposed to a drug
(erdafitinib - an FGFR inhibitor). We blotted for three proteins -
TRAIL, PARP, and Actin.</p>
<p>Here is our PARP blot:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to ImageMagick 6.9.11.60</span></span>
<span><span class="co">#&gt; Enabled features: fontconfig, freetype, fftw, heic, lcms, pango, webp, x11</span></span>
<span><span class="co">#&gt; Disabled features: cairo, ghostscript, raw, rsvg</span></span>
<span><span class="co">#&gt; Using 4 threads</span></span>
<span><span class="va">parp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"parp.tif"</span>, package <span class="op">=</span> <span class="st">"blotbench"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">parp</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>After blotting for PARP, we probed the same blot again for TRAIL:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"trail.tif"</span>, package <span class="op">=</span> <span class="st">"blotbench"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trail</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>And finally for Actin:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">actin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"actin.tif"</span>, package <span class="op">=</span> <span class="st">"blotbench"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">actin</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>We’re also going to create column and row annotations while we’re at
it.</p>
<p>Column annotations are probably the most involved, so we’ll start
with them.</p>
<p>To make the column annotation, create a <code>data.frame</code> that
has one row per lane in the blot. The columns should represent
experimental conditions. The order of the rows should be the order of
the columns <strong>after image manipulation</strong>. This is
important, as these images are mirrored - we’ll flip them the right way
once we get on to image manipulation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="st">"Erdafitinib"</span>, <span class="st">"Erdafitinib"</span>, <span class="st">"Erdafitinib"</span><span class="op">)</span>,</span>
<span>  time_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, <span class="fl">48</span>, <span class="fl">72</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Row annotation can be supplied as a <code>data.frame</code> with just
one column - <code>name</code> - or, much more simply, as a character
vector, which is what we’ll do here. The order should match the order of
images.</p>
<p>With that, we have everything we need:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb.html">wb</a></span><span class="op">(</span></span>
<span>  imgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parp</span>, <span class="va">trail</span>, <span class="va">actin</span><span class="op">)</span>,</span>
<span>  col_annot <span class="op">=</span> <span class="va">ca</span>,</span>
<span>  row_annot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PARP"</span>, <span class="st">"TRAIL"</span>, <span class="st">"Actin"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="editing-blots">Editing blots<a class="anchor" aria-label="anchor" href="#editing-blots"></a>
</h2>
<p>Now that we have a blot object, we can call
<code>wb_visual_edit</code> on it to help us generate code to transform
out blots:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wb_visual_edit.html">wb_visual_edit</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span></span></code></pre></div>
<p>After editing your individual blots and clicking “done”, the app will
quit and the code to write the transformations will appear in your
console:</p>
<pre><code>Paste in your script to crop the images as seen in the app:
transforms(wb) &lt;- tibble::tribble(
  ~width, ~height, ~xpos, ~ypos, ~rotate, ~flip,
    190L,     60L,   269,    51,    -0.5,  TRUE,
    190L,     50L,   238,   276,       0,  TRUE,
    190L,     30L,   283,   206,       0,  TRUE
  )</code></pre>
<p>Doing so, we get:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transforms.html">transforms</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">width</span>, <span class="op">~</span><span class="va">height</span>, <span class="op">~</span><span class="va">xpos</span>, <span class="op">~</span><span class="va">ypos</span>, <span class="op">~</span><span class="va">rotate</span>, <span class="op">~</span><span class="va">flip</span>,</span>
<span>    <span class="fl">190L</span>,     <span class="fl">60L</span>,   <span class="fl">269</span>,    <span class="fl">51</span>,    <span class="op">-</span><span class="fl">0.5</span>,  <span class="cn">TRUE</span>,</span>
<span>    <span class="fl">190L</span>,     <span class="fl">50L</span>,   <span class="fl">238</span>,   <span class="fl">276</span>,       <span class="fl">0</span>,  <span class="cn">TRUE</span>,</span>
<span>    <span class="fl">190L</span>,     <span class="fl">30L</span>,   <span class="fl">283</span>,   <span class="fl">206</span>,       <span class="fl">0</span>,  <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">wb</span></span>
<span><span class="co">#&gt; $imgs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;   format width height colorspace matte filesize density</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TIFF     696    520 Gray       FALSE   <span style="text-decoration: underline;">728</span>306 83x83  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TIFF     696    520 Gray       FALSE   <span style="text-decoration: underline;">728</span>306 83x83  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TIFF     696    520 Gray       FALSE   <span style="text-decoration: underline;">728</span>306 83x83  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col_annot</span></span>
<span><span class="co">#&gt;          drug time_hr</span></span>
<span><span class="co">#&gt; 1        DMSO       0</span></span>
<span><span class="co">#&gt; 2 Erdafitinib      24</span></span>
<span><span class="co">#&gt; 3 Erdafitinib      48</span></span>
<span><span class="co">#&gt; 4 Erdafitinib      72</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $row_annot</span></span>
<span><span class="co">#&gt;    name</span></span>
<span><span class="co">#&gt; 1  PARP</span></span>
<span><span class="co">#&gt; 2 TRAIL</span></span>
<span><span class="co">#&gt; 3 Actin</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $transforms</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">#&gt;   width height  xpos  ypos rotate flip </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   190     60   269    51   -<span style="color: #BB0000;">0.5</span> TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   190     50   238   276    0   TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   190     30   283   206    0   TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "wb"</span></span></code></pre></div>
<p>Note that the transforms have not been <em>applied</em>: the
<code>imgs</code> are still the width and height that they were before
updating the transformations. This allows you to re-edit the blots if
you so desire. The transformations can manually be applied using
<code>apply_transforms</code>, but they are also automatically applied
upon <code>present_wb</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wb_present.html">wb_present</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>You’ll note that our annotations have automatically been applied -
isn’t that nice!</p>
<p>If you want to exclude certain proteins, you can index by row just
like a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wb_present.html">wb_present</a></span><span class="op">(</span><span class="va">wb</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>You can additionally select lanes as though they were columns:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wb_present.html">wb_present</a></span><span class="op">(</span><span class="va">wb</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>In practice, this will allow you to do some pretty un-recommended
things - but by providing the code, at least it’s auditable.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
